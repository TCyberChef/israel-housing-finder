# Plan: 05-01 — Search & Filters UI

**Phase:** 5 — Search & Filters
**Status:** COMPLETE
**Completed:** 2026-02-17

## Goal

Add real-time search and filtering to the listing discovery experience. Users can narrow
results by city/address text, price range, and room count, with sort control and live map
synchronization.

## Requirements Addressed

SRCH-01, SRCH-04, SRCH-05, SRCH-14

## Approach

Client-side filtering via two new hooks:
- `useFilters` — filter state management (search, priceMin, priceMax, rooms, sortBy)
- `useFilteredListings` — pure memoized function: `(listings, filters) => Listing[]`

`FilterPanel` component renders above the listing list inside `SplitLayout.listContent`.
Filtered listings are passed to both `LeafletMap` and `ListingList` so map pins and cards
always match.

## Files Created / Modified

| File | Action |
|------|--------|
| `src/hooks/useFilters.ts` | Created — Filters type, DEFAULT_FILTERS, useFilters hook |
| `src/hooks/useFilteredListings.ts` | Created — useMemo filter/sort logic |
| `src/components/Filters/FilterPanel.tsx` | Created — search input, price inputs, room buttons, sort select |
| `src/components/Filters/FilterPanel.css` | Created — RTL-aware styles |
| `src/i18n/locales/he/common.json` | Updated — filters.* keys in Hebrew |
| `src/i18n/locales/en/common.json` | Updated — filters.* keys in English |
| `src/App.tsx` | Updated — wired useFilters + useFilteredListings + FilterPanel |

## Key Decisions

- **Client-side filtering over Supabase queries:** Dataset is small enough (<5k listings),
  avoids round-trips and enables instant map+list sync without refetching.
- **Rooms as minimum:** filter `rooms=3` shows 3, 3.5, 4, 5 rooms — matches user intent
  (minimum bedrooms, not exact count).
- **Sort sortBy='date_desc' as default:** Newest listings first is standard for rental search.
- **No submit button:** Filters apply on every keystroke/click for real-time feedback.
- **hasActiveFilters flag:** Shows "Clear filters" button only when filters are non-default.

## Success Criteria

1. ✅ Text search filters listing cards and map pins by city or address
2. ✅ Price min/max inputs filter listings to price range
3. ✅ Room buttons filter listings to ≥N rooms
4. ✅ Sort select reorders filtered results
5. ✅ Result count shown in filter bar
6. ✅ "Clear filters" resets all to defaults
7. ✅ Hebrew and English strings for all filter labels
8. ✅ TypeScript compiles without errors
9. ✅ Vite build succeeds
